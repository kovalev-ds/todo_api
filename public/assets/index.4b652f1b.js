var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,s=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,l=(e,l)=>{for(var r in l||(l={}))t.call(l,r)&&s(e,r,l[r]);if(a)for(var r of a(l))n.call(l,r)&&s(e,r,l[r]);return e};import{r,a as o,p as c,b as i,u,c as m,G as d,d as p,e as E,C as g,N as f,f as h,g as v,h as y,i as b,j as T,k as A,l as x,A as N,m as k,B as S,S as _,R as w,n as L,o as O,q as D,s as R,t as C,v as I,w as U,x as F,y as P,z as j,P as M,D as G}from"./vendor.0edcb716.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,l)=>{const r=new URL(e,n);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const o=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){l(new Error(`Failed to import: ${e}`)),s(c)},onload(){a(self[t].moduleMap[r]),s(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("/assets/");const K=(e,t)=>{r.useEffect((()=>{const a=a=>{a.key===e&&t()};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}}),[])};var z,$,H,q,B;($=z||(z={})).SET_USER_DATA="auth/SET_USER_DATA",$.DESTROY_USER_DATA="auth/DESTROY_USER_DATA",$.FAILED_REQUEST="auth/FAILED_REQUEST",$.CLEAR_ERRORS="auth/CLEAR_ERRORS",(q=H||(H={})).DELETE_COMPLETED="tasks/DELETE_COMPLETED",q.CREATE_TASK="tasks/CREATE_TASK",q.FETCH_ONE="tasks/FETCH_ONE",q.FETCH_ALL="tasks/FETCH_ALL",q.UPDATE_TASK="tasks/UPDATE_TASK",q.DELETE_TASK="tasks/DELETE_TASK",q.SET_LOADING="tasks/SET_LOADING",q.STOP_LOADING="tasks/STOP_LOADING",(B||(B={})).INIT="app/INIT";const J=()=>{const e=window.localStorage.getItem("user");if(e){const{token:t}=JSON.parse(e);return{"x-access-token":t}}return{}},Q=o.create({baseURL:"http://localhost:3001/api/",headers:{"Content-type":"application/json"}});var V=new class{register(e,t,a){return Q.post("auth/signup",{username:e,email:t,password:a}).then((e=>(e.data.success&&window.localStorage.setItem("user",JSON.stringify(e.data)),e.data)))}logout(){return window.localStorage.removeItem("user"),Promise.resolve()}login(e,t){return Q.post("auth/signin",{email:e,password:t}).then((e=>(e.data.success&&window.localStorage.setItem("user",JSON.stringify(e.data)),e.data)))}check(){return Q.get("auth/me",{headers:J()}).then((e=>(e.data.success&&window.localStorage.setItem("user",JSON.stringify(e.data)),e.data)))}};const Y=e=>({type:z.SET_USER_DATA,payload:e}),W=()=>({type:z.DESTROY_USER_DATA}),X=e=>({type:z.FAILED_REQUEST,payload:e});var Z=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",signInAction:(e,t)=>a=>{V.login(e,t).then((e=>{if(e.success)return a(Y(e)),void a(c("/"));a(X(e.message))}))},signOutAction:()=>e=>{V.logout().then((()=>{e(W()),e(c("/auth"))}))},signUpAction:(e,t,a)=>n=>{V.register(e,t,a).then((e=>{if(e.success)return n(Y(e)),void n(c("/"));n(X(e.message))}))},setAuthUserData:Y,destroyUserData:W,failedRequest:X,clearAuthErrors:()=>({type:z.CLEAR_ERRORS})});var ee=new class{fetchAll(){return Q.get("tasks/",{headers:J()}).then((e=>e.data))}create(e){return Q.post("tasks/",e,{headers:J()}).then((e=>e.data))}deleteOne(e){return Q.delete(`tasks/${e}`,{headers:J()})}deleteMany(e){return Q.delete("/tasks",{headers:J(),data:e})}update(e,t){return Q.put(`tasks/${e}`,t,{headers:J()})}fetchOne(e){return Q.get(`tasks/${e}`,{headers:J()}).then((e=>e.data))}};var te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",fetchAllTasks:()=>e=>{e({type:H.SET_LOADING}),ee.fetchAll().then((t=>{e({type:H.FETCH_ALL,payload:t})})).catch((()=>{e({type:H.FETCH_ALL,payload:[]})}))},updateTask:(e,t)=>a=>{a({type:H.SET_LOADING}),ee.update(e,t).then((()=>{a({type:H.UPDATE_TASK,payload:{id:e,data:t}})}))},createTask:(e,t)=>a=>{const n={title:e,description:t,completed:!1};a({type:H.SET_LOADING}),ee.create(n).then((e=>{a({type:H.CREATE_TASK,payload:e})}))},deleteTask:e=>t=>{t({type:H.SET_LOADING}),ee.deleteOne(e).then((()=>{t({type:H.DELETE_TASK,payload:{id:e}})}))},deleteCompleted:()=>e=>{e({type:H.SET_LOADING}),ee.deleteMany({completed:!0}).then((()=>{e({type:H.DELETE_COMPLETED})})).finally((()=>e({type:H.STOP_LOADING})))}});const ae=()=>({type:B.INIT});var ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",initializeApp:()=>e=>{V.check().then((t=>{t.success&&e(Y(t))})).catch((()=>{V.logout().then((()=>W())).then((()=>e(c("/auth"))))})).finally((()=>e(ae())))}}),se=l(l(l({},ne),Z),te);const le=()=>{const e=u();return i(se,e)},re=e=>{const{isActive:t,setIsActive:a,setValue:n,value:s,handleSubmit:l}=e,o=r.useRef(null);return r.useEffect((()=>{var e;null==(e=o.current)||e.focus()}),[]),r.createElement("form",{className:"mb-4",id:"todo-form",onSubmit:e=>{e.preventDefault(),l()}},r.createElement("div",{className:"flex flex-col relative space-y-1"},r.createElement("input",{value:s,onChange:e=>n(e.target.value),ref:o,className:m("h-14 px-6 bg-[#F6F8F9] placeholder-[#616770] border-none","focus:ring-0 focus:outline-none focus:shadow"),type:"text",placeholder:"What needs to be done?",autoComplete:"off"}),r.createElement("button",{onClick:a,type:"button",className:m("absolute inset-y-0 right-0 w-12 inline-flex items-center justify-center","focus:outline-none focus:ring-0")},r.createElement("div",{className:"p-2 rounded-lg hover:bg-gray-100 active:bg-gray-200"},t?r.createElement(d,null):r.createElement(p,null)))))},oe=()=>{const{loading:e,tasks:t}=E((e=>e.task)),a=t.filter((e=>!e.completed)).length;return r.createElement("div",{className:"px-6 py-2 flex justify-between items-center"},r.createElement("div",{className:"text-sm"},e?r.createElement(g,{className:"animate-spin"}):r.createElement("span",null,a>1?`${a} tasks.`:`${a} task.`)),r.createElement("ul",{className:"flex items-center space-x-1 -mx-4"},r.createElement("li",null,r.createElement(f,{to:"/",exact:!0,activeClassName:"nav-active",className:"nav"},"all")),r.createElement("li",null,r.createElement(f,{to:"/active",activeClassName:"nav-active",className:"nav"},"active")),r.createElement("li",null,r.createElement(f,{to:"/completed",activeClassName:"nav-active",className:"nav"},"completed"))))},ce=e=>{const{edit:t,task:{id:a,title:n,completed:s}}=e,{deleteTask:l,updateTask:o}=le(),c=h();return r.createElement("li",{className:"h-12 px-6 shadow-sm bg-white flex items-center relative"},r.createElement("input",{className:"p-2.5 rounded border-none bg-[#e8e8e8]",type:"checkbox",name:"completed",checked:s,onChange:()=>o(a,{completed:!s})}),r.createElement("div",{className:m("flex-1 px-4 text-gray-900",s&&"line-through")},n),r.createElement("div",{className:"flex items-center h-full -mx-4 group"},r.createElement("button",{onClick:()=>l(a),className:"btn-icon hidden group-hover:inline-flex"},r.createElement(v,null)),r.createElement("button",{onClick:t,className:"btn-icon hidden group-hover:inline-flex"},r.createElement(y,null)),r.createElement("button",{onClick:()=>c.push(`tasks/${a}`),className:"btn-icon hidden group-hover:inline-flex"},r.createElement(b,null)),r.createElement("button",{className:"btn-icon inline-flex group-hover:hidden"},r.createElement(T,null))))},ie=({editTask:e})=>{const{fetchAllTasks:t}=le(),{tasks:a,loading:n}=E((e=>e.task)),{filter:s}=A(),[l,o]=r.useState([]);return r.useEffect((()=>{t()}),[]),r.useEffect((()=>{o((()=>a.filter((({completed:e})=>"active"===s?!e:"completed"!==s||e))))}),[a,s]),0!==l.length||n?r.createElement("ul",{className:"space-y-1.5 bg-[#F6F8F9] py-2"},l.map((t=>r.createElement(ce,{key:t.id,task:t,edit:()=>e(t)})))):r.createElement("div",{className:"not-found text-gray-600"},"Not found a task.")},ue=e=>{const{value:t,setValue:a,children:n}=e;return r.createElement("div",{className:"flex flex-col space-y-3"},r.createElement("textarea",{className:"bg-[#f8f4e8] placeholder-[#B39D43] px-6 border-none resize-none\n            focus:shadow focus:outline-none focus:ring-0",placeholder:"Describe your task",rows:4,form:"todo-form",value:t,onChange:e=>a(e.target.value)}),n)},me={title:"",description:""},de=()=>{const[e,t]=r.useState(!1),[a,n]=r.useState(),[{title:s,description:o},c]=r.useState(me),{createTask:i,updateTask:u}=le();K("Escape",(()=>{t((()=>!1)),n((()=>null)),c((()=>me))}));return r.createElement(r.Fragment,null,r.createElement(oe,null),r.createElement(re,{isActive:e,setIsActive:()=>t((e=>!e)),value:s,setValue:e=>c((t=>l(l({},t),{title:e}))),handleSubmit:()=>{s&&(a?u(a,{title:s,description:o}):i(s,o),t((()=>!1)),c((()=>me)),n((()=>null)))}}),e?r.createElement(ue,{value:o,setValue:e=>c((t=>l(l({},t),{description:e})))},r.createElement("button",{form:"todo-form",type:"submit",className:"btn-primary mr-2"},a?"Edit Task":"Add Task")):r.createElement(ie,{editTask:e=>{const{id:a,title:s,description:l}=e;n((()=>a)),t((()=>!0)),c((()=>({title:s,description:l})))}}))},pe=()=>{const[e,t]=r.useState("signin"),{register:a,handleSubmit:n}=x(),{signInAction:s,signUpAction:o,clearAuthErrors:c}=le(),{error:i}=E((e=>e.auth)),u=n((({email:t,password:a,username:n})=>{"signin"===e?s(t,a):o(n,t,a)}));return r.createElement("div",{className:"px-6"},r.createElement("h2",{className:"text-3xl"},"signin"===e?"Sign in":"Sign up"),r.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Or"," ",r.createElement("span",{onClick:()=>{c(),t((e=>"signin"===e?"signup":"signin"))},className:"font-medium cursor-pointer text-indigo-600 hover:text-indigo-500"},"signin"===e?"create new account":"login into existing account")),i&&r.createElement("p",{className:"text-red-500 text-sm"},"*",i),r.createElement("form",{className:"mt-4",onSubmit:u},"signup"===e&&r.createElement("div",null,r.createElement("label",{className:"text-sm font-medium",htmlFor:"username"},"Username"),r.createElement("input",l(l({},a("username")),{id:"username",type:"text",required:!0,autoComplete:"off",className:"appearance-none rounded-md relative block w-full px-3 py-2 mt-1 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Username"}))),r.createElement("div",null,r.createElement("label",{className:"text-sm font-medium",htmlFor:"email"},"Email"),r.createElement("input",l(l({},a("email")),{id:"email",type:"email",required:!0,autoComplete:"off",className:"appearance-none rounded-md relative block w-full px-3 py-2 mt-1 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address"}))),r.createElement("div",null,r.createElement("label",{className:"text-sm font-medium",htmlFor:"password"},"Password"),r.createElement("input",l(l({},a("password")),{id:"password",type:"password",required:!0,autoComplete:"off",className:"appearance-none rounded-md relative block w-full px-3 py-2 mt-1 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password"}))),r.createElement("div",null,r.createElement("button",{type:"submit",className:"relative w-full flex justify-center py-2 px-4 mt-6 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"signin"===e?"Sign in":"Sign up"))))},Ee=()=>{const[e,t]=r.useState(!1),{signOutAction:a,deleteCompleted:n}=le(),s=r.useRef(null);((e,t)=>{r.useEffect((()=>{const a=a=>{const n=null==e?void 0:e.current;n&&!n.contains(a.target)&&t(a)};return document.addEventListener("click",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("click",a),document.removeEventListener("touchstart",a)}}),[e,t])})(s,(()=>t((()=>!1)))),K("Escape",(()=>t((()=>!1))));const{auth:{isAuth:l,user:o},task:{tasks:c}}=E((e=>e));return l?r.createElement("div",{ref:s,className:"relative -mx-4 flex space-x-1"},c.filter((e=>e.completed)).length>0&&r.createElement("button",{onClick:n,title:"remove completed",className:"block text-lg p-2 rounded-lg hover:bg-gray-100 focus:outline-none focus:bg-gray-100"},r.createElement(N,null)),r.createElement("button",{onClick:()=>t((e=>!e)),className:"block text-lg p-2 rounded-lg hover:bg-gray-100 focus:outline-none focus:bg-gray-100"},r.createElement(k,null)),e&&r.createElement("div",{className:"absolute z-10 p-4 py-6 w-56 right-0 top-10 rounded bg-[#F6F8F9] shadow text-right"},r.createElement("div",{className:"text-lg"},o.username),r.createElement("div",{className:"text-sm text-gray-500 mb-2"},o.email),r.createElement("button",{className:"btn-primary",onClick:a},"logout"))):null},ge=()=>{const{id:e}=A(),t=h(),[a,n]=r.useState(null),[s,l]=r.useState(!0);return r.useEffect((()=>{let t;return ee.fetchOne(parseInt(e)).then((e=>{t=setTimeout((()=>{n(e),l(!1)}),500)})).catch((e=>{l(!1)})),()=>clearTimeout(t)}),[e]),r.createElement("div",{className:"px-6"},r.createElement("button",{onClick:()=>t.push("/"),className:"text-lg pr-2 transition-transform transform hover:-translate-x-1 active:outline-none active:ring-0"},r.createElement(S,null)),s&&r.createElement("div",{className:"animate-pulse tracking-wider"},"loading..."),a&&r.createElement(r.Fragment,null,r.createElement("div",null,"task: ",r.createElement("span",{className:"font-bold"},a.title)," "),a.description&&r.createElement("div",null,"description: ",r.createElement("span",{className:"italic"},a.description)," "),r.createElement("div",null,"status:"," ",a.completed?r.createElement("span",{className:"text-green-500"},"completed"):r.createElement("span",{className:"text-red-500"},"in process"))),!a&&!s&&r.createElement("div",null,"task with id ",r.createElement("span",{className:"font-medium"},e)," not found."))},fe=()=>{const{initializeApp:e}=le(),{inited:t}=E((e=>e.app));return r.useEffect((()=>{const t=setTimeout((()=>{e()}),500);return()=>clearTimeout(t)}),[]),t?r.createElement("section",{className:"py-6"},r.createElement("div",{className:"max-w-lg mx-auto flex flex-col rounded-lg shadow bg-white h-[80vh] overflow-hidden"},r.createElement("div",{className:"p-6 pb-4 flex justify-between items-center"},r.createElement("h1",{className:"text-3xl tracking-wide"},"todo app"),r.createElement(Ee,null)),r.createElement("div",{className:"flex-1 overflow-auto"},r.createElement(_,null,r.createElement(w,{path:"/auth",exact:!0,component:pe}),r.createElement(w,{path:["/","/:filter"],exact:!0,component:de}),r.createElement(w,{path:"/tasks/:id",component:ge}),r.createElement(L,{to:"/"}))))):r.createElement("div",{className:"text-2xl text-center tracking-widest mt-10"},"Loading...")},he={loading:!1,tasks:[]},ve=(e=he,t)=>{const{type:a,payload:n}=t;switch(a){case H.CREATE_TASK:return{tasks:[...e.tasks,n],loading:!1};case H.DELETE_TASK:return{tasks:e.tasks.filter((e=>e.id!==n.id)),loading:!1};case H.DELETE_COMPLETED:return l(l({},e),{tasks:e.tasks.filter((e=>!e.completed)),loading:!1});case H.UPDATE_TASK:return l(l({},e),{tasks:e.tasks.map((e=>e.id===n.id?l(l({},e),n.data):e)),loading:!1});case H.FETCH_ALL:return{tasks:n,loading:!1};case H.SET_LOADING:return l(l({},e),{loading:!0});case H.STOP_LOADING:return l(l({},e),{loading:!1});default:return e}},ye={isAuth:!1,user:null,error:null},be=(e=ye,t)=>{const{type:a,payload:n}=t;switch(a){case z.SET_USER_DATA:return{isAuth:!0,user:n,error:null};case z.DESTROY_USER_DATA:return{isAuth:!1,user:null,error:null};case z.FAILED_REQUEST:return{isAuth:!1,user:null,error:n};case z.CLEAR_ERRORS:return l(l({},e),{error:null});default:return e}},Te={inited:!1},Ae=(e=Te,t)=>{const{type:a}=t;switch(a){case B.INIT:return{inited:!0};default:return e}},xe=R(),Ne=[F,P(xe)];const ke=C(O({app:Ae,task:ve,auth:be,router:D(xe)}),{},I(U(...Ne)));j.render(r.createElement(r.StrictMode,null,r.createElement(M,{store:ke},r.createElement(G,{history:xe},r.createElement(fe,null)))),document.getElementById("root"));
